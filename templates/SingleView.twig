{% extends "/layout/layout.twig" %}

{% block navbarContent %}
    {% if isAdmin %}
        <a href="../public/index.php?page=adminView"><img src="../public/img/logo-JF-v3.png" alt=""></a>
            <ul class="navbar-nav text-uppercase ml-auto">
                <li class="nav-item active">
                    <a href="../public/index.php?page=adminView#publishChapter" class="navbar-nav-link">Chapitres publiés</a>
                </li>
                <li>
                    <a href="../public/index.php?page=adminView#pendingChapter" class="navbar-nav-link">Chapitres en attente</a>
                </li>    
                <li>
                    <a href="../public/index.php?page=adminView#commentModeration" class="navbar-nav-link">Modération</a>
                </li>
                <a href="../public/index.php?page=getLogout" class="btn navbar-button">Déconnexion</a>
            </ul>
    {% else %}
        <a href="../public/index.php"><img src="../public/img/logo-JF-v3.png" alt=""></a>
            <ul class="navbar-nav text-uppercase ml-auto">
                <li class="nav-item active">
                    <a href="../public/index.php#publishChapter" class="navbar-nav-link">Accéder aux chapitres</a>
                </li>
                <li class="nav-item">
                    <a href="../public/index.php#about" class="navbar-nav-link">A propos</a>
                </li>
                <li class="nav-item">
                    <a href="../public/index.php?page=contact" class="navbar-nav-link">Contact</a>
                </li>
                <a href="../public/index.php?page=getLogin" class="btn navbar-button"><span class="button-text">Connexion</span></a>
            </ul>
    {% endif %}
{% endblock  navbarContent %}

{% block mainHeader %}
<div class="page-title text-center">
    <div class="container page-title-container">
        <p class="page-title-text">Chapitre {{ uniqueChapter.id }} :</p>
        <h1 class="text-lead page-title-h1"><span>{{ uniqueChapter.title}}</span></h1>
    </div>
</div>
{% endblock %}

{% block main %}
<div class="text-center">
    {% if chapterNumber <= 1 and chapterNumber is defined %}            
        <a href="../public/index.php?page=single&chapterId={{ chapterNumber + 1 }}" class="btn btn-info my-2">Chapitre Suivant</a>
    {% else %}
        <a href="../public/index.php?page=single&chapterId={{ chapterNumber - 1 }}" class="btn btn-info my-2">Chapitre précédent</a>
        <a href="../public/index.php?page=single&chapterId={{ chapterNumber + 1 }}"class="btn btn-info my-2">Chapitre Suivant</a> 
    {% endif %}  
</div>
<section id="publishChapter" class="container">
        <div class="card my-4 text-center">
            <h2 class="card-header">{{ uniqueChapter.title }}</h2>
            <p class="card-body">
                Posté le 
                <span class="font-italic">{{ uniqueChapter.createDate }}</span> 
                par 
                <span class="font-italic">{{ uniqueChapter.author }}</span>
            </p>
            <p class="text-center-justify"> {{ uniqueChapter.content }}</p>
        </div>
        {% if isAdmin %}
            <div class="text-center">
                <a href="../public/index.php?page=adminView" class="btn btn-info my-2">Retour à l'accueil</a>
            </div>  
        {% else %}
            <div class="text-center">
                <a href="../public/index.php" class="btn btn-info my-2">Retour à l'accueil</a>
            </div>
        {% endif %}
    </div>
</section>
<hr>
<section class="comment" class="container"> 
    <h4 class="text-center">Commentaire</h4>
        {% for comment in commentList %}
            <div class="container text-center">
                <div class="card my-4">
                    <p class="card-header">
                        Posté le <span class="font-italic">{{ comment.createdDate }}</span> 
                        par <span class="font-italic bold">{{ comment.author }}</span>
                        <span class="float-right">totalReports = {{ totalReports }}</span>
                    </p>
                    <p class="card-body my-4">
                        {{ comment.content }}
                    </p>
                    <div class="reporting-button">
                        <a href="../public/index.php?page=reportComment&chapterId={{ uniqueChapter.id }}&commentId={{ comment.id }}"
                            class="btn btn-warning custom">Signaler ce commentaire
                        </a>
                    </div>
                </div>
            </div>
        {% else %}
            <h2 class="card-header text-center">Aucun commentaires</h2>
        {% endfor %}
        </div>
    </div>
</section>
<hr>
<section class="container">
    <div class="card text-center my-4">
    <h3 class="card-header">Ajouter un commentaire</h3>
        <form action="index.php?page=addComment&chapterId={{ uniqueChapter.id }}" method="post" class="card-body">
            <div class="form-group">
                <label for="commentAuthor" class="bold">Pseudonyme</label>    
                <input type="text" class="form-control" id="commentAuthor" name="commentAuthor"></input>
                <label for="commentTitle" class="bold">Titre</label>
                <input type="text" class="form-control" id="commentTitle" name="commentTitle">
                <label for="commentContent" class="bold">Votre commentaire</label>
                <textarea type="text" class="form-control" id="commentContent" name="commentContent" rows="10"></textarea>
                <button type="submit" name="submit" class="btn btn-primary my-2">Soumettre commentaire</button>
            </div>
        </form>    
    </div>  
</section>
{% endblock main %}
