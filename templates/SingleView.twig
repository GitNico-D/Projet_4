{% extends "/layout/layout.twig" %}

{% block navbarContent %}
    {% if isAdmin %}
        <a class="navbar-brand" href="../public/index.php?page=adminView"><img src="../public/img/logo-homepage-resize.png" alt=""></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarmain" aria-controls="navbarmain" aria-expanded="false" aria-label="Toggle navigation">
            <span class="fas fa-bars"></span>
        </button>  
        <div class="collapse navbar-collapse" id="navbarmain">
            <ul class="navbar-nav text-uppercase mr-auto">
                <li class="nav-item">
                    <a href="../public/index.php?page=adminView#publishChapter" class="nav-link">Chapitres publiés</a>
                </li>
                <li class="nav-item">
                    <a href="../public/index.php?page=adminView#pendingChapter" class="nav-link">Chapitres en attente</a>
                </li>
                <li class="nav-item">
                    <a href="../public/index.php?page=adminView#commentModeration" class="nav-link">Modération</a>
                </li>
            </ul>
        </div>
        <a href="../public/index.php?page=getLogout" class="btn navbar-button">Déconnexion</a>
    {% else %}
        <a class="navbar-brand" href="../public/index.php"><img src="../public/img/logo-homepage-resize.png" alt=""></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarmain" aria-controls="navbarmain" aria-expanded="false" aria-label="Toggle navigation">
            <span class="fas fa-bars"></span>
        </button>  
        <div class="collapse navbar-collapse show" id="navbarmain">
        <ul class="navbar-nav text-uppercase mr-auto">
            <li class="nav-item">
                <a href="../public/index.php#about" class="nav-link ">A propos</a>
            </li>
            <li class="nav-item">
                <a href="../public/index.php#publishChapter" class="nav-link ">Accéder aux chapitres</a>
            </li>
            <li class="nav-item">
                <a href="../public/index.php?page=contact" class="nav-link ">Contact</a>
            </li>
        </ul>
        <div class="text-center">
            <a href="../public/index.php?page=getLogin" class="btn navbar-button"><span class="button-text">Connexion</span></a>
        </div>
    {% endif %}
{% endblock  navbarContent %}

{% block mainHeader %}
<div class="page-title text-center">
    <div class="container page-title-container">
        <p class="page-title-text">Chapitre {{ uniqueChapter.id }} :</p>
        <h1 class="text-lead page-title-h1"><span>{{ uniqueChapter.title}}</span></h1>
    </div>
</div>
<hr class="singlePageSeparator">
{% endblock %}

{% block main %}
<section id="publishChapter" class="container">
        <div class="card my-4 publishChapterSingleCard">
            <p class="card-header float-right publishChapterSingleCard-header">
            Publié le 
                <span class="font-italic bold">{{ uniqueChapter.createDate }}</span> 
                par 
                <span class="font-italic bold">{{ uniqueChapter.author }}</span>
            </p>
            <p class="card-body publishChapterSingleCard-body text-center-justify"> {{ uniqueChapter.content }}</p>
        </div>
        <div class="text-center">
            {% if chapterNumber <= 1 and chapterNumber is defined %}            
                <a href="../public/index.php?page=single&chapterId={{ chapterNumber + 1 }}" class="btn nextChapter-btn my-2">Chapitre Suivant</a>
            {% else %}
                <a href="../public/index.php?page=single&chapterId={{ chapterNumber - 1 }}" class="btn previousChapter-btn my-2">Chapitre précédent</a>
                <a href="../public/index.php?page=single&chapterId={{ chapterNumber + 1 }}"class="btn nextChapter-btn my-2">Chapitre Suivant</a> 
            {% endif %}  
        </div>
        {% if isAdmin %}
            <div class="singlePage-return text-center">
                <a href="../public/index.php?page=adminView" class=" my-2">Retour à l'accueil</a>
            </div>  
        {% else %}
            <div class="singlePage-return text-center">
                <a href="../public/index.php" class="my-2">Retour à l'accueil</a>
            </div>
        {% endif %}
    </div>
</section>
<hr class="commentSeparator">
<section id="comment" class="container"> 
    <h4 class="text-left">{{ totalComments }} Commentaires</h4>
        {% for comment in commentList %}
            <div class="container text-center">
                <div class="my-4 commentCard">
                    <p class="text-left card-header commentCard-header">
                        <span class="font-italic bold">{{ comment.author }}</span>
                        posté le <span class="font-italic">{{ comment.createdDate }}</span> 
                        <span class="float-right">totalReports = {{ totalReports }}</span>
                    </p>
                    <p class="card-body text-left commentCard-content">
                        {{ comment.content }}
                    </p>
                    <div class="reporting-comment text-left">
                        <a href="../public/index.php?page=reportComment&chapterId={{ uniqueChapter.id }}&commentId={{ comment.id }}"
                            class="reporting-link">Signaler<i class="fa fa-thumbs-down reporting-icon"></i></a>
                    </div>
                </div>
            </div>
        {% else %}
            <h2 class="card-header text-center">Aucun commentaires</h2>
        {% endfor %}
        </div>
    </div>
</section>
<hr class="commentSeparator">
<section class="container">
    <div class=" my-4">
    <h4 class="leaveComment-title">Laisser un commentaire</h4>
        <form action="index.php?page=createComment&chapterId={{ uniqueChapter.id }}" method="post" class="leaveComment-form">
            <div class="form-group">
                <label for="commentAuthor" class="bold">Pseudonyme</label>    
                <input type="text" class="form-control" id="commentAuthor" name="commentAuthor"></input>
                <label for="commentTitle" class="bold">Titre</label>
                <input type="text" class="form-control" id="commentTitle" name="commentTitle">
                <label for="commentContent" class="bold">Votre commentaire</label>
                <textarea type="text" class="form-control" id="commentContent" name="commentContent" rows="10"></textarea>
                <div class="commentButton text-center">

                    <button type="submit" name="submit" class="btn leaveComment-btn my-2">Soumettre commentaire</button>
                </div>
            </div>
        </form>    
    </div>  
</section>
{% endblock main %}
